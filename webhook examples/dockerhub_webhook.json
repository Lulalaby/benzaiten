{
    "push_data": {
      "pushed_at": 1580950972,
      "images": [],
      "tag": "0.0.8",
      "pusher": "zeigren"
    },
    "callback_url": "https://registry.hub.docker.com/u/zeigren/inventree/hook/2i1gehc0igiai4agcf4500de32di3d5cf/",
    "repository": {
      "status": "Active",
      "description": "Docker For InvenTree A Open Source Inventory Management System",
      "is_trusted": false,
      "full_description": "[![Docker Hub](https://img.shields.io/docker/cloud/build/zeigren/inventree)](https://hub.docker.com/r/zeigren/inventree)\n[![](https://images.microbadger.com/badges/image/zeigren/inventree.svg)](https://microbadger.com/images/zeigren/inventree)\n[![](https://images.microbadger.com/badges/version/zeigren/inventree.svg)](https://microbadger.com/images/zeigren/inventree)\n[![](https://images.microbadger.com/badges/commit/zeigren/inventree.svg)](https://microbadger.com/images/zeigren/inventree)\n\n## Docker For [InvenTree](https://github.com/inventree/InvenTree)\n\n### [Docker Hub](https://hub.docker.com/r/zeigren/inventree)\n\n### [GitHub](https://github.com/Zeigren/inventree-docker)\n\n### Stack\n\n- [Python:Alpine](https://hub.docker.com/_/python) for InvenTree and Gunicorn\n- [Nginx:Alpine](https://hub.docker.com/_/nginx)\n- [MariaDB:10](https://hub.docker.com/_/mariadb)\n\n#### For Development\n\n- [phpMyAdmin](https://hub.docker.com/r/phpmyadmin/phpmyadmin/)\n\n## Tags\n\nBuilds are automatically triggered and tagged when InvenTree or the container image is updated.\n\nThe tags follow this naming scheme:\n\n- container.version-date\n- container.version (this will be the same as the newest container.version-date)\n- latest (this will be the same as the newest container.version-date)\n\n## Usage\n\nUse [Docker Compose](https://docs.docker.com/compose/) or [Docker Swarm](https://docs.docker.com/engine/swarm/) to deploy InvenTree for either development or production.\n\nClone the [GitHub](https://github.com/Zeigren/inventree-docker) repository and create a `config` folder inside the `inventree-docker` directory.\n\nI like using [Portainer](https://www.portainer.io/) since it makes all the tinkering easier, but it's not necessary.\n\n### Quick Test\n\nTo give it a quick test copy the `inventree_dev_vhost.conf` file into the config folder and run the `docker-compose -f docker-compose.yml -f test.yml up -d` command in the `inventree-docker` directory. This will pull all the Docker images and run them.\n\nOnce they're running edit the `docker-compose.yml` file and change `MIGRATE_STATIC` to `True`, then run `docker-compose -f docker-compose.yml -f test.yml up -d` again (this step will be fixed at some point). This does all the database initialization and collects all the static files.\n\nNow you'll need to create the superuser run `docker exec -it inventree python manage.py createsuperuser`. Open up a web browser and go to `127.0.0.1:9080` and you're good to go!\n\n### Configuration\n\nConfiguration consists of environment variables in the `docker-compose.yml`, `test.yml`, `development.yml`, `production.yml`, and `docker-stack.yml` files or as files contained in the `config` folder.\n\nUsing [multiple Docker Compose files](https://docs.docker.com/compose/extends/#multiple-compose-files) makes it easier to differentiate between use cases. `docker-compose.yml` is the base configuration file and `test.yml`, `development.yml`, and `production.yml` are used to either add or override the base configuration.\n\n#### `docker-compose.yml`\n\nSettings for MariaDB\n\n- MYSQL_ROOT_PASSWORD=CHANGEME\n- MYSQL_DATABASE=inventree\n- MYSQL_USER=inventree\n- MYSQL_PASSWORD=CHANGEME\n\nDatabase migration and collects the static files, use as needed\n\n- MIGRATE_STATIC=False\n\n#### `test.yml`, `development.yml`, and `production.yml`\n\nEnable debug\n\n- DEBUG=True\n\n#### Config Files\n\nThe configuration files that can be placed in the `config` folder are:\n\n- inventree_dev_vhost.conf = A simple Nginx vhost file for InvenTree, for development and local testing\n- inventree_prod_vhost.conf = Nginx vhost file for InvenTree that includes SSL termination (simply replace all instances of `YOURDOMAIN`)\n- YOURDOMAIN.com.crt = The SSL certificate for your domain (you’ll need to create/copy this)\n- YOURDOMAIN.com.key = The SSL key for your domain (you’ll need to create/copy this)\n- dhparam.pem = Diffie-Hellman parameter (you’ll need to create/copy this)\n- secret_key.txt = A secret key for Django\n\nFor Development:\ndev_requirements.txt = A pip requirements file that can be used in development (example provided)\n\n### Production\n\nReplace all instances of `YOURDOMAIN` in `production.yml` and `inventree_prod_vhost.conf`. Then run `docker-compose -f docker-compose.yml -f production.yml up -d`. If you want to use a specific version of InvenTree change the image used in `production.yml`.\n\n### [Docker Swarm](https://docs.docker.com/engine/swarm/)\n\nI use this with [Traefik](https://traefik.io/) as a reverse proxy, but it’s not necessary.\n\nYou’ll need to create these [Docker Secrets](https://docs.docker.com/engine/swarm/secrets/):\n\n- YOURDOMAIN.com.crt = The SSL certificate for your domain (you’ll need to create/copy this)\n- YOURDOMAIN.com.key = The SSL key for your domain (you’ll need to create/copy this)\n- dhparam.pem = Diffie-Hellman parameter (you’ll need to create/copy this)\n- InvenTreesql_root_password = Root password for your SQL database\n- InvenTreesql_password = InvenTree user password for your SQL database\n- secret_key = A secret key for Django\n\nYou’ll also need to create this [Docker Config](https://docs.docker.com/engine/swarm/configs/):\n\n- inventree_vhost = The Nginx vhost file for InvenTree (use the inventree_prod_vhost.conf template and simply replace all instances of `YOURDOMAIN`)\n\nMake whatever changes you need to docker-stack.yml (replace all instances of `YOURDOMAIN`).\n\nRun with `docker stack deploy --compose-file docker-stack.yml inventree`\n\n## Theory of operation\n\n### InvenTree\n\nThe [Dockerfile](https://docs.docker.com/engine/reference/builder/) uses [multi-stage builds](https://docs.docker.com/develop/develop-images/multistage-build/), [build hooks](https://docs.docker.com/docker-hub/builds/advanced/#build-hook-examples), and [labels](http://label-schema.org/rc1/#build-time-labels) for automated builds on Docker Hub.\n\nThe multi-stage build creates a container that can be used for development and another for production. The development container has all the build dependencies for the python packages which are installed into a [python virtual environment](https://docs.python.org/3/tutorial/venv.html). The production container copies the python virtual environment from the development container and runs InvenTree from there, this allows it to be much more lightweight.\n\nOn startup, the container first runs the `docker-entrypoint.sh` script before running the `gunicorn -c gunicorn.conf.py InvenTree.wsgi` command.\n\n`docker-entrypoint.sh` creates configuration files and runs commands based on environment variables that are declared in the various compose files.\n\n`env_secrets_expand.sh` handles using Docker Secrets.\n\n### Nginx\n\nUsed as a web server. It serves up the static files and passes everything else off to gunicorn/InvenTree.\n\n### MariaDB\n\nSQL database.\n\n## Development\n\n### Run\n\nClone the [InvenTree](https://github.com/inventree/InvenTree) repository into a folder called `InvenTree` and build the development Docker image by running `docker build . --target development -t inventree:development`. Then use `docker-compose -f docker-compose.yml -f development.yml up -d` to grab all the other Docker images and run InvenTree.\n\n### InvenTree Development\n\nThe clone you made of InvenTree replaces the one in the Docker container when the container is started (as seen in `development.yml`). So any changes you make are reflected in the Docker container (you may need to restart the container for those changes to take effect).\n\nIf you want to develop/test using the production container you can build it using `docker build . --target production -t inventree:production`, then change the image tag in `development.yml`.\n\n### Python\n\nIf you need to change which python packages are installed you can create/alter the `dev_requirements.txt` file and uncomment the line in the `Dockerfile`. Then run `docker build . --target development -t inventree:development`  to rebuild the container, this will install `dev_requirements.txt` instead of the default InvenTree `requirements.txt`.\n\n### Docs\n\nIf you installed the required packages using `dev_requirements.txt` you can make the docs by running `docker exec -it -w /usr/src/app make docs`.\n\n### phpMyAdmin\n\nUseful for database administration, you can connect to phpMyAdmin at `127.0.0.1:6060`.\n",
      "repo_url": "https://hub.docker.com/r/zeigren/inventree",
      "owner": "zeigren",
      "is_official": false,
      "is_private": false,
      "name": "inventree",
      "namespace": "zeigren",
      "star_count": 0,
      "comment_count": 0,
      "date_created": 1576632843,
      "dockerfile": "FROM python:alpine AS development\n\nENV PYTHONDONTWRITEBYTECODE 1\nENV PYTHONUNBUFFERED 1\nENV INVENTREE_ROOT=\"/usr/src/app\"\nENV INVENTREE_HOME=\"/usr/src/app/InvenTree\"\nENV INVENTREE_STATIC=\"/usr/src/static\"\nENV INVENTREE_MEDIA=\"/usr/src/media\"\nENV VIRTUAL_ENV=\"/opt/venv\"\nENV PATH=\"$VIRTUAL_ENV/bin:$PATH\"\n\nRUN apk add --no-cache \\\n    gcc mariadb-dev libjpeg-turbo-dev zlib-dev git musl-dev make bash libgcc libstdc++\n\n# Uncomment COPY and change DEV=\"True\" to install new requirements in development\n#COPY dev_requirements.txt /usr/src/dev_requirements.txt\nENV DEV=\"False\"\n\nRUN git clone --branch master --depth 1 https://github.com/inventree/InvenTree.git ${INVENTREE_ROOT} \\\n    && python -m venv $VIRTUAL_ENV \\\n    && pip install --upgrade pip \\\n    && if [ $DEV = True ] ; \\\n    then pip install --no-cache-dir -U -r /usr/src/dev_requirements.txt mysqlclient gunicorn ; \\\n    else pip install --no-cache-dir -U -r /usr/src/app/requirements.txt mysqlclient gunicorn ; fi\n\nCOPY env_secrets_expand.sh docker-entrypoint.sh /\n\nRUN chmod +x /env_secrets_expand.sh \\\n    && chmod +x /docker-entrypoint.sh\n\nWORKDIR ${INVENTREE_HOME}\n\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n\nCMD [\"gunicorn\", \"-c\", \"gunicorn.conf.py\", \"InvenTree.wsgi\"]\n\n\nFROM python:alpine AS production\n\nARG BRANCH\nARG COMMIT\nARG DATE\nARG URL\nARG VERSION\n\nLABEL org.label-schema.schema-version=\"1.0\" \\\n    org.label-schema.build-date=$DATE \\\n    org.label-schema.vendor=\"Zeigren\" \\\n    org.label-schema.name=\"zeigren/inventree\" \\\n    org.label-schema.url=\"https://hub.docker.com/r/zeigren/inventree\" \\\n    org.label-schema.version=$VERSION \\\n    org.label-schema.vcs-url=$URL \\\n    org.label-schema.vcs-branch=$BRANCH \\\n    org.label-schema.vcs-ref=$COMMIT\n\nENV PYTHONUNBUFFERED 1\nENV INVENTREE_ROOT=\"/usr/src/app\"\nENV INVENTREE_HOME=\"/usr/src/app/InvenTree\"\nENV VIRTUAL_ENV=\"/opt/venv\"\nENV PATH=\"$VIRTUAL_ENV/bin:$PATH\"\n\nRUN apk add --no-cache \\\n    mariadb-connector-c git make libjpeg-turbo zlib\n\nCOPY --from=development $VIRTUAL_ENV $VIRTUAL_ENV\nCOPY --from=development $INVENTREE_ROOT $INVENTREE_ROOT\nCOPY env_secrets_expand.sh docker-entrypoint.sh /\n\nRUN chmod +x /env_secrets_expand.sh \\\n    && chmod +x /docker-entrypoint.sh\n\nWORKDIR ${INVENTREE_HOME}\n\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n\nCMD [\"gunicorn\", \"-c\", \"gunicorn.conf.py\", \"InvenTree.wsgi\"]\n",
      "repo_name": "zeigren/inventree"
    }
  }
